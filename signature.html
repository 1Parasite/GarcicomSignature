<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Signature – MS Solutions</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
<style>
  * { box-sizing: border-box; margin: 0; padding: 0; }
  body {
    background-color: #F5F5FF;
    font-family: Calibri, Arial, sans-serif;
    padding: 40px 20px;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 16px;
    min-height: 100vh;
  }
  .page-topbar {
    display: flex; align-items: center; justify-content: space-between;
    width: 100%; max-width: 680px;
  }
  .page-topbar img { height: 36px; width: auto; }
  .page-label {
    font-size: 10px; font-weight: 700; letter-spacing: 0.14em;
    text-transform: uppercase; color: #8788FF;
    width: 100%; max-width: 680px;
  }
  .action-row { display: flex; gap: 10px; width: 100%; max-width: 680px; }
  .btn {
    flex: 1; height: 42px; border: none; border-radius: 8px;
    font-family: Calibri, Arial, sans-serif; font-size: 14px;
    font-weight: 700; cursor: pointer; transition: all 0.15s;
    display: flex; align-items: center; justify-content: center;
    text-decoration: none; letter-spacing: 0.02em;
  }
  .btn-primary { background: #0C144E; color: #fff; }
  .btn-primary:hover { background: #1a2d6b; box-shadow: 0 4px 14px rgba(12,20,78,.3); }
  .btn-secondary { background: #fff; color: #8788FF; border: 2px solid #C5C6FF; }
  .btn-secondary:hover { background: #F0F0FF; }
  #qr-gen { position: absolute; left: -9999px; top: -9999px; }

  @keyframes fadeUp {
    from { opacity: 0; transform: translateY(10px); }
    to   { opacity: 1; transform: translateY(0); }
  }
  .page-topbar       { animation: fadeUp 0.35s ease both 0s; }
  .page-label        { animation: fadeUp 0.35s ease both 0.06s; }
  #signature-wrapper { animation: fadeUp 0.35s ease both 0.12s; }
  .action-row        { animation: fadeUp 0.35s ease both 0.18s; }
</style>
</head>
<body>

<div class="page-topbar">
  <a href="https://www.mssolutions-group.com" target="_blank">
    <img src="https://raw.githubusercontent.com/1Parasite/GarcicomSignature/refs/heads/main/assets/icones-ms-01.png" alt="MS Solutions">
  </a>
</div>

<div class="page-label">Preview — Email Signature</div>

<div id="signature-wrapper">

<!--[if mso]>
<table role="presentation" cellpadding="0" cellspacing="0" border="0" width="600" style="width:600px;">
<tr><td>
<![endif]-->

<table role="presentation" cellpadding="0" cellspacing="0" border="0"
  width="600"
  style="width:600px;max-width:600px;border-collapse:collapse;mso-table-lspace:0pt;mso-table-rspace:0pt;background-color:#ffffff;">

  <!-- ── MAIN ROW ── -->
  <tr>

    <!-- LOGO CELL -->
    <td width="160" valign="middle"
      style="width:160px;padding:18px 14px 18px 16px;vertical-align:middle;">
      <a href="https://www.mssolutions-group.com" target="_blank" style="text-decoration:none;border:0;display:block;">
        <img src="https://raw.githubusercontent.com/1Parasite/GarcicomSignature/refs/heads/main/assets/icones-ms-01.png"
             alt="MS Solutions"
             width="155" height="auto"
             style="display:block;width:155px;height:auto;border:0;outline:0;text-decoration:none;mso-line-height-rule:exactly;">
      </a>
    </td>

    <!-- INFO CELL — centered vertically between logo and QR -->
    <td valign="middle"
      style="padding:18px 10px;vertical-align:middle;">

      <!-- Name line -->
      <table role="presentation" cellpadding="0" cellspacing="0" border="0"
        style="border-collapse:collapse;mso-table-lspace:0pt;mso-table-rspace:0pt;margin:0 0 4px 0;">
        <tr>
          <td style="font-family:Calibri,Arial,sans-serif;font-size:20px;font-weight:700;color:#0C144E;line-height:1.2;mso-line-height-rule:exactly;padding:0;white-space:nowrap;">
            <span id="sig-name" style="font-weight:700;color:#0C144E;font-family:Calibri,Arial,sans-serif;font-size:20px;">Name</span>&nbsp;<span id="sig-surname" style="font-weight:900;color:#0C144E;font-family:Calibri,Arial,sans-serif;font-size:20px;letter-spacing:0.3px;">SURNAME</span>
          </td>
        </tr>
      </table>

      <!-- Function -->
      <table role="presentation" cellpadding="0" cellspacing="0" border="0"
        style="border-collapse:collapse;mso-table-lspace:0pt;mso-table-rspace:0pt;margin:0 0 12px 0;">
        <tr>
          <td style="padding:0;">
            <p id="sig-function"
              style="margin:0;padding:0;font-family:Calibri,Arial,sans-serif;font-size:13px;font-weight:400;color:#8788FF;line-height:1.3;mso-line-height-rule:exactly;">
              Function
            </p>
          </td>
        </tr>
      </table>

      <!-- Email row -->
      <table role="presentation" cellpadding="0" cellspacing="0" border="0"
        style="border-collapse:collapse;mso-table-lspace:0pt;mso-table-rspace:0pt;margin:0 0 8px 0;">
        <tr>
          <td valign="middle" style="vertical-align:middle;">
            <a id="sig-email-link" href="#"
              style="font-family:Calibri,Arial,sans-serif;font-size:13px;color:#0C144E;line-height:1.3;mso-line-height-rule:exactly;text-decoration:none;display:inline;">
              <span id="sig-email"></span>
            </a>
          </td>
        </tr>
      </table>

      <!-- Phone row -->
      <table role="presentation" cellpadding="0" cellspacing="0" border="0"
        style="border-collapse:collapse;mso-table-lspace:0pt;mso-table-rspace:0pt;margin:0 0 8px 0;">
        <tr>
          <td width="24" valign="middle"
            style="width:24px;padding:0 8px 0 0;vertical-align:middle;font-size:0;line-height:0;">
            <img src="https://raw.githubusercontent.com/1Parasite/GarcicomSignature/refs/heads/main/assets/icones-ms-03.png"
                 alt="" width="18" height="18"
                 style="display:block;width:18px;height:18px;border:0;outline:0;">
          </td>
          <td valign="middle" style="vertical-align:middle;">
            <span id="sig-phone"
              style="font-family:Calibri,Arial,sans-serif;font-size:13px;color:#0C144E;line-height:1.3;mso-line-height-rule:exactly;">
              +216 00 000 000
            </span>
          </td>
        </tr>
      </table>

      <!-- Social row: LinkedIn + YouTube -->
      <table role="presentation" cellpadding="0" cellspacing="0" border="0"
        style="border-collapse:collapse;mso-table-lspace:0pt;mso-table-rspace:0pt;margin:0 0 8px 0;">
        <tr>
          <td width="24" valign="middle"
            style="width:24px;padding:0 6px 0 0;vertical-align:middle;font-size:0;line-height:0;">
            <a id="linkedin-link" href="https://www.linkedin.com/company/mss-group-sparking-trusted-payment/" target="_blank"
              style="text-decoration:none;border:0;display:block;">
              <img src="https://raw.githubusercontent.com/1Parasite/GarcicomSignature/refs/heads/main/assets/icones-ms-05.png"
                   alt="LinkedIn" width="18" height="18"
                   style="display:block;width:18px;height:18px;border:0;outline:0;">
            </a>
          </td>
          <td width="24" valign="middle"
            style="width:24px;padding:0 12px 0 0;vertical-align:middle;font-size:0;line-height:0;">
            <a href="https://www.youtube.com/channel/UCCVqglSGQvGJK5i_UdbApzA" target="_blank"
              style="text-decoration:none;border:0;display:block;">
              <img src="https://raw.githubusercontent.com/1Parasite/GarcicomSignature/refs/heads/main/assets/icones-ms-06.png"
                   alt="YouTube" width="18" height="18"
                   style="display:block;width:18px;height:18px;border:0;outline:0;">
            </a>
          </td>
          <td valign="middle" style="vertical-align:middle;">
            <span style="font-family:Calibri,Arial,sans-serif;font-size:13px;color:#0C144E;line-height:1.3;mso-line-height-rule:exactly;">
              MS Solutions Group
            </span>
          </td>
        </tr>
      </table>

      <!-- Booking row -->
      <table role="presentation" cellpadding="0" cellspacing="0" border="0"
        style="border-collapse:collapse;mso-table-lspace:0pt;mso-table-rspace:0pt;">
        <tr>
          <td width="24" valign="middle"
            style="width:24px;padding:0 8px 0 0;vertical-align:middle;font-size:0;line-height:0;">
            <img src="https://raw.githubusercontent.com/1Parasite/GarcicomSignature/refs/heads/main/assets/icones-ms-04.png"
                 alt="" width="18" height="18"
                 style="display:block;width:18px;height:18px;border:0;outline:0;">
          </td>
          <td valign="middle" style="vertical-align:middle;">
            <span id="booking-link"
              style="font-family:Calibri,Arial,sans-serif;font-size:13px;color:#0C144E;line-height:1.3;mso-line-height-rule:exactly;text-decoration:none;display:inline;">
              Book a meeting with me
            </span>
          </td>
        </tr>
      </table>

    </td>

    <!-- QR CELL — equal padding to logo side -->
    <td width="130" valign="middle" align="center"
      style="width:130px;padding:18px 16px 18px 10px;vertical-align:middle;text-align:center;">

      <table role="presentation" cellpadding="0" cellspacing="0" border="0" align="center"
        style="border-collapse:collapse;margin:0 auto;mso-table-lspace:0pt;mso-table-rspace:0pt;">
        <!-- Top corners -->
        <tr>
          <td width="18" height="18" style="width:18px;height:18px;padding:0;line-height:0;font-size:0;">
            <img src="https://raw.githubusercontent.com/1Parasite/GarcicomSignature/refs/heads/main/assets/coins-04.png"
                 width="18" height="18" alt="" style="display:block;border:0;width:18px;height:18px;">
          </td>
          <td width="110" height="18" style="width:110px;height:18px;padding:0;line-height:0;font-size:0;background-color:#ffffff;"></td>
          <td width="18" height="18" style="width:18px;height:18px;padding:0;line-height:0;font-size:0;">
            <img src="https://raw.githubusercontent.com/1Parasite/GarcicomSignature/refs/heads/main/assets/coins-01.png"
                 width="18" height="18" alt="" style="display:block;border:0;width:18px;height:18px;">
          </td>
        </tr>
        <!-- QR image -->
        <tr>
          <td colspan="3" align="center" style="padding:0;line-height:0;font-size:0;text-align:center;">
            <img id="qr-img" src="" alt="QR Code" width="110" height="110"
                 style="display:block;width:110px;height:110px;border:0;outline:0;margin:0 auto;">
          </td>
        </tr>
        <!-- Bottom corners -->
        <tr>
          <td width="18" height="18" style="width:18px;height:18px;padding:0;line-height:0;font-size:0;">
            <img src="https://raw.githubusercontent.com/1Parasite/GarcicomSignature/refs/heads/main/assets/coins-03.png"
                 width="18" height="18" alt="" style="display:block;border:0;width:18px;height:18px;">
          </td>
          <td style="padding:0;line-height:0;font-size:0;background-color:#ffffff;"></td>
          <td width="18" height="18" style="width:18px;height:18px;padding:0;line-height:0;font-size:0;">
            <img src="https://raw.githubusercontent.com/1Parasite/GarcicomSignature/refs/heads/main/assets/coins-02.png"
                 width="18" height="18" alt="" style="display:block;border:0;width:18px;height:18px;">
          </td>
        </tr>
      </table>

      <p style="margin:6px 0 0 0;padding:0;font-family:Calibri,Arial,sans-serif;font-size:11px;color:#8788FF;text-align:center;line-height:1.3;mso-line-height-rule:exactly;letter-spacing:0.4px;">
        Reach out to me
      </p>

    </td>

  </tr>

  <!-- BANNER ROW -->
  <tr>
    <td colspan="3" style="padding:0;line-height:0;font-size:0;mso-line-height-rule:exactly;">
      <img src="https://raw.githubusercontent.com/1Parasite/GarcicomSignature/main/assets/Banner%20(1).png"
           alt="" width="600" height="auto"
           style="display:block;width:600px;height:auto;border:0;outline:0;text-decoration:none;">
    </td>
  </tr>

  <!-- CONFIDENTIALITY ROW — FIX: font-size and line-height locked on the <td> itself -->
  <tr>
    <td colspan="3" style="padding:5px 20px 7px 20px;background-color:#ffffff;font-size:9px;line-height:1.4;mso-line-height-rule:exactly;">
      <p style="margin:0;padding:0;font-family:Calibri,Arial,sans-serif;font-style:italic;font-size:9px;color:#888899;line-height:1.4;mso-line-height-rule:exactly;max-height:none;overflow:visible;">
        Confidentiality notice: this e-mail and its attachments are confidential and intended solely for the addressed recipient(s). If you are not the intended recipient, please do not disclose, copy, distribute, or rely on its contents.
      </p>
    </td>
  </tr>

</table>

</div>

<div id="qr-gen"></div>

<div class="action-row">
  <button onclick="window.location.href='PageEdit.html'" class="btn btn-secondary">← Edit</button>
  <button class="btn btn-primary" id="copy-btn" onclick="copySignature()">⎘ Copy Signature</button>
</div>

<script>
(function () {
  var params   = new URLSearchParams(window.location.search);
  var rawPhone = (params.get('phone') || '').replace(/\D/g, '');
  var meetLink = params.get('meet')    || '';
  var name     = params.get('name')    || 'Name';
  var surname  = params.get('surname') || 'SURNAME';
  var func     = params.get('func')    || 'Function';
  var email    = params.get('email')   || 'name.surname@mssolutions-group.com';
  var linkedin = params.get('linkedin')|| '';

  document.getElementById('sig-name').textContent     = name;
  document.getElementById('sig-surname').textContent  = surname.toUpperCase();
  document.getElementById('sig-function').textContent = func;

  document.getElementById('sig-email').textContent    = email;
  document.getElementById('sig-email-link').href      = 'mailto:' + email;

  if (rawPhone) {
    document.getElementById('sig-phone').textContent = '+' + rawPhone;
  }
  if (linkedin) {
    document.getElementById('linkedin-link').href = linkedin;
  }
  if (meetLink) {
    document.getElementById('booking-link').href = meetLink;
  }

  // ── QR generation ──────────────────────────────────────────────
  var useCustomQR  = params.get('customqr') === '1';
  var customQRData = useCustomQR ? sessionStorage.getItem('customQR') : null;

  if (customQRData) {
    // FIX: explicitly enforce dimensions via style when using a custom QR image
    var qrImg = document.getElementById('qr-img');
    qrImg.src = customQRData;
    qrImg.setAttribute('width', '110');
    qrImg.setAttribute('height', '110');
    qrImg.style.cssText = 'display:block;width:110px;height:110px;border:0;outline:0;margin:0 auto;';
  } else {
    var contactParams = new URLSearchParams({
      phone: rawPhone, name: name, surname: surname,
      func: func, email: email, linkedin: linkedin
    });
    var basePath   = window.location.href.split('?')[0].replace(/signature\.html$/i, '');
    var contactURL = basePath + 'contact.html?' + contactParams.toString();

    new QRCode(document.getElementById('qr-gen'), {
      text: contactURL,
      width: 200, height: 200,
      colorDark:  '#0C144E',
      colorLight: '#ffffff',
      correctLevel: QRCode.CorrectLevel.M
    });

    setTimeout(function () {
      var canvas = document.querySelector('#qr-gen canvas');
      if (canvas) {
        document.getElementById('qr-img').src = canvas.toDataURL('image/png');
      }
    }, 350);
  }

  window.copySignature = function () {
    var wrapper = document.getElementById('signature-wrapper');
    var clone   = wrapper.cloneNode(true);

    var scratch = clone.querySelector('#qr-gen');
    if (scratch) scratch.parentNode.removeChild(scratch);

    var sigHTML = clone.innerHTML;

    if (navigator.clipboard && window.ClipboardItem) {
      var htmlBlob = new Blob([sigHTML], { type: 'text/html' });
      var textBlob = new Blob([wrapper.innerText], { type: 'text/plain' });
      navigator.clipboard
        .write([new ClipboardItem({ 'text/html': htmlBlob, 'text/plain': textBlob })])
        .then(function ()  { showFeedback(true);  })
        .catch(function () { fallbackCopy(sigHTML); });
    } else {
      fallbackCopy(sigHTML);
    }
  };

  function fallbackCopy(html) {
    var el = document.createElement('div');
    el.setAttribute('contenteditable', 'true');
    el.style.cssText = 'position:fixed;top:-9999px;left:-9999px;opacity:0;pointer-events:none;font-family:Calibri,Arial,sans-serif;';
    el.innerHTML = html;
    document.body.appendChild(el);

    var range = document.createRange();
    range.selectNodeContents(el);
    var sel = window.getSelection();
    sel.removeAllRanges();
    sel.addRange(range);

    var ok = false;
    try { ok = document.execCommand('copy'); } catch (e) {}

    sel.removeAllRanges();
    document.body.removeChild(el);
    showFeedback(ok);
  }

  function showFeedback(ok) {
    var btn = document.getElementById('copy-btn');
    btn.textContent      = ok ? '✓ Copied!' : '✗ Try again';
    btn.style.background = ok ? '#1a7a3a'  : '#b03030';
    setTimeout(function () {
      btn.textContent      = '⎘ Copy Signature';
      btn.style.background = '';
    }, 2400);
  }

})();
</script>
</body>
</html>